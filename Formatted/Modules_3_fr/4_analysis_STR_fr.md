---
​---
title: Analysis of sample data collected under stratified random sampling
summary: In this tutorial we will apply various estimators to a sample dataset to estimate characteristics of the population sampled -- i.e. characteristics of the study area such as the area of forest disturbance. This tutorial will focus on sampled data collected under stratified random sampling
author: Pontus Olofsson
creation date: February, 2021
language: English
publisher and license: Copyright 2021, World Bank. This work is licensed under a Creative Commons Attribution 3.0 IGO

tags:
- OpenMRV
- GEE
- AREA2
- Accuracy
- Accuracy assessment
- Area Estimation
- Colombia

group:
- category: Stratified
  stage: Area Estimation/Accuracy assessment
​---
---



# Analysis of sample data collected under stratified random sampling

## 1. Contexte

Dans les tutoriels précédents, nous avons conçu et réalisé un échantillon pour la Colombie, et nous avons observé et documenté les données de référence de l'occupation du sol à chaque unité d'échantillonnage. La collection d'observations de référence est appelée les résultats ou les données de l'échantillon, ou encore la classification de référence. Dans ce tutoriel, nous appliquerons divers estimateurs aux données de l'échantillon pour estimer les caractéristiques de la population que nous avons échantillonnée, à savoir les caractéristiques telles que la zone de perturbation des forêts. Un estimateur est “ la règle par laquelle une estimation d'une caractéristique de la population [c'est-à-dire un paramètre] *μ* est calculée à partir des résultats de l'échantillon” (Cochran, 1977, p. 11)[^fn1]. Notez qu'un estimateur n'est pas la même chose qu'une estimation - au contraire, “un estimateur est une fonction de l'échantillon, tandis qu'une estimation est la valeur réalisée d'un estimateur (c'est-à-dire un nombre) qui est obtenue lorsqu'un échantillon est effectivement prélevé ” (Casella & Berger, 2002, p. 312)[^fn2]. Un estimateur possède deux propriétés importantes : la variance et le biais. Le biais d'un estimateur *μ^* d'un paramètre de population *μ* est la différence entre *μ* et la valeur attendue de *μ^* sur tous les échantillons possibles ; soit , [![img](https://camo.githubusercontent.com/0a124237fea316e5d657b6f75cfa463307793bdf49738b559fbb5426df5f67a9/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543696e6c696e652673706163653b25354374657874757025374242696173253744282535436861742537422535436d75253744292673706163653b3d2673706163653b25354374657874757025374245253744282535436861742537422535436d75253744292673706163653b2d2673706163653b2535436d75)](https://camo.githubusercontent.com/0a124237fea316e5d657b6f75cfa463307793bdf49738b559fbb5426df5f67a9/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543696e6c696e652673706163653b25354374657874757025374242696173253744282535436861742537422535436d75253744292673706163653b3d2673706163653b25354374657874757025374245253744282535436861742537422535436d75253744292673706163653b2d2673706163653b2535436d75) (Casella & Berger, 2002, p. 330)[^fn2]. Si [![img](https://camo.githubusercontent.com/e5e04116142d61c833f0e7b6448aaf64d482b730db11cb20b4661a866906ec93/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543696e6c696e652673706163653b25354374657874757025374242696173253744282535436861742537422535436d75253744292673706163653b3d2673706163653b25354374657874757025374245253744282535436861742537422535436d75253744292673706163653b2d2673706163653b2535436d753d30)](https://camo.githubusercontent.com/e5e04116142d61c833f0e7b6448aaf64d482b730db11cb20b4661a866906ec93/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543696e6c696e652673706163653b25354374657874757025374242696173253744282535436861742537422535436d75253744292673706163653b3d2673706163653b25354374657874757025374245253744282535436861742537422535436d75253744292673706163653b2d2673706163653b2535436d753d30), alors l'estimateur est dit sans biais. Notez que parce qu'une estimation est un nombre, elle n'a pas de variance ni de biais et ne peut donc pas être sans biais.

L'autre propriété importante d'un estimateur est la variance. La définition formelle de la variance indique “une mesure du degré de dispersion d'une distribution autour de sa moyenne” (Casella & Berger, 2002, p. 59)[^fn2]. Cette définition n'est pas très utile dans notre contexte, nous nous intéressons plutôt aux situations dans lesquelles nous avons échantillonné une zone d'étude pour estimer un certain paramètre de population (par exemple, la superficie de la forêt ou la déforestation). Par exemple, si nous avons une population de dans laquelle un échantillon de a été sélectionné, la variance de l'échantillon est *s^2^* et est facilement calculée pour les plans d'échantillonnage courants. Mais la variance de l'échantillon est moins intéressante que la variance d'un estimateur. Pour les plans d'échantillonnage courants, nous pouvons facilement prouver que la variance de l'échantillon *s^2^* est un estimateur sans biais de la variance de la population *S^2^* (Cochran, 1977, p. 22, 26)[^fn1]. La variance d'un estimateur *u^* [![img](https://camo.githubusercontent.com/06f72d13b4ac52188eccb8cdf11aff5dd0eb293b7f548eb136c12607cb5e4fc5/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543696e6c696e652673706163653b25354374657874757025374256253744282535436861742537422535436d75253744292673706163653b3d2673706163653b53253545322673706163653b2535436469762673706163653b6e)](https://camo.githubusercontent.com/06f72d13b4ac52188eccb8cdf11aff5dd0eb293b7f548eb136c12607cb5e4fc5/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543696e6c696e652673706163653b25354374657874757025374256253744282535436861742537422535436d75253744292673706163653b3d2673706163653b53253545322673706163653b2535436469762673706163653b6e) (en supposant une petite taille d'échantillon, *n*, par rapport à la taille de la population, *N*)); la variance estimée de *u^* substitue la variance de l'échantillon *s^2^* à la variance de la population *S^2^* pour créer l'estimateur de variance de *u^* comme [![img](https://camo.githubusercontent.com/70b5db5d67b6dc02868c46296e02cceea82eb2b361cb9f8c9e791d301a786b5b/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543696e6c696e652673706163653b25354368617425374256253744282535436861742537422535436d75253744292673706163653b3d2673706163653b73253545322673706163653b2535436469762673706163653b6e)](https://camo.githubusercontent.com/70b5db5d67b6dc02868c46296e02cceea82eb2b361cb9f8c9e791d301a786b5b/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543696e6c696e652673706163653b25354368617425374256253744282535436861742537422535436d75253744292673706163653b3d2673706163653b73253545322673706163653b2535436469762673706163653b6e) qui est l'estimateur de variance qui nous intéresse le plus car il nous permet de quantifier l'incertitude dans des choses comme les données d'activité ou d'autres paramètres importants.

A partir de là, nous pouvons introduire deux mesures plus importantes de la dispersion : l'erreur standard et l'intervalle de confiance. L'erreur standard est l'écart type (c'est-à-dire la racine carrée de la variance) d'un estimateur (Rice, 1995, p. 192)[^fn3] et a donc la même unité que l'estimation. L'écart-type d'un estimateur est appelé son erreur-type. Comme la variance de l'échantillon est un estimateur sans biais de la variance de la population, nous pouvons estimer l'erreur standard à l'aide de la variance de l'échantillon : [![img](https://camo.githubusercontent.com/0427c01f6a33aeee4b7a31db2a96dba1c23729b4939ed280ad82842e59e6bdfd/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543696e6c696e652673706163653b2535437465787475702537425345253744282535436861742537422535436d75253744292673706163653b3d2673706163653b25354368617425374256253744282535436861742537422535436d75253744292673706163653b2535436469762673706163653b253543737172742537426e253744)](https://camo.githubusercontent.com/0427c01f6a33aeee4b7a31db2a96dba1c23729b4939ed280ad82842e59e6bdfd/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543696e6c696e652673706163653b2535437465787475702537425345253744282535436861742537422535436d75253744292673706163653b3d2673706163653b25354368617425374256253744282535436861742537422535436d75253744292673706163653b2535436469762673706163653b253543737172742537426e253744). Notez que, comme une erreur standard est un écart type d'un estimateur, toutes les erreurs standard sont également des écarts types, mais tous les écarts types ne sont pas des erreurs standard. Cela prête parfois à confusion, même si les définitions de l'erreur standard et de l'écart standard sont cohérentes. Ni la variance ni l'erreur standard ne sont généralement utilisées pour exprimer l'incertitude des estimations, à la place, un intervalle de confiance est couramment utilisé : " Un intervalle de confiance de 95 % pour *μ* est un intervalle aléatoire qui contient *μ* avec une probabilité de 0,95 ; si nous devions prendre de nombreux échantillons aléatoires [selon le même plan d'échantillonnage] et former un intervalle de confiance à partir de chacun d'eux, environ 95 % de ces intervalles contiendraient *μ*." (Rice, 1995, p. 217)[^fn3]. Les intervalles de confiance sont souvent de la forme [![img](https://camo.githubusercontent.com/4524fcedf9dec9bd0a4882b9f787f1cd11ad363239b7a5b8a41e95135a65f3cf/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543696e6c696e652673706163653b2535436861742537422535436d752537442673706163653b253543706d2673706163653b6125354374696d65732535437465787475702537425345253744282535436861742537422535436d7525374429)](https://camo.githubusercontent.com/4524fcedf9dec9bd0a4882b9f787f1cd11ad363239b7a5b8a41e95135a65f3cf/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543696e6c696e652673706163653b2535436861742537422535436d752537442673706163653b253543706d2673706163653b6125354374696d65732535437465787475702537425345253744282535436861742537422535436d7525374429) où *a* est une statistique liée au niveau de confiance souhaité, appelée score z ou score standard, exprimée en pourcentage entre 0 et 100 %. Pour un certain niveau de confiance *p*, l'aire sous la fonction de densité normale standard de *-z* à *+z* est *p* (Rice, 1995, p. 202)[^fn3]; par exemple, un intervalle de confiance au niveau de confiance de 95% correspond à un z-score de 1,96 (souvent arrondi à 2). Une condition pour utiliser un z-score pour calculer un intervalle de confiance est que la distribution de l'échantillonnage soit approximativement une distribution normale, ce que l'on peut supposer pour des échantillons de grande taille. L'intervalle de confiance divisé par l'estimation est appelé marge d'erreur (*MdE*) et est souvent exprimé en pourcentage.

Les deux propriétés, biais et variance, sont importantes car nous pouvons nous assurer que l'estimateur que nous utilisons est sans biais et nous pouvons exprimer l'incertitude des estimations. Ni l'un ni l'autre n'est possible lorsqu'on utilise le comptage de pixels dans les cartes ou lorsqu'on procède à un échantillonnage sans appliquer le principe de l'échantillonnage probabiliste. Un autre aspect important d'un estimateur est qu'il est une fonction de l'échantillon, ce qui signifie que l'estimateur doit correspondre au plan d'échantillonnage. Par exemple, la moyenne de l'échantillon est un estimateur sans biais de la moyenne de la population pour un échantillonnage aléatoire simple ; pour un échantillonnage aléatoire stratifié, nous devons utiliser un estimateur stratifié qui est exprimé comme la somme des moyennes des échantillons aléatoires simples dans les strates pondérées par les poids des strates.

## 2 Learning Objectives

- Construct STR estimator and STR variance estimator
- Estimate overall user’s producer’s accuracy of a map using reference observations
- Estimate map accuracy and area estimation

### 2.1 Pre-requisites for this module

- Relevant terminology is found at the end of this document
- More information about sampling design, and response design can be found here on OpenMRV under processes "Sampling design", and "Sample data collection".



## 3 Tutorial: Analysis of sample data collected under stratified random sampling

### 3.1 L'estimation stratifiée

Lors de l'analyse de l'échantillon SRS dans l'exemple ci-dessus, aucune donnée cartographique n'a été utilisée. Bien qu'un échantillonnage aléatoire simple facilite la sélection et l'analyse de l'échantillon, nous pouvons obtenir un gain de précision dans les estimations si nous stratifions la zone d'étude avant de tirer l'échantillon. En particulier, si les strates sont définies pour correspondre à des sous-populations homogènes, c'est-à-dire que les caractéristiques de la population "varient peu d'une unité à l'autre, des estimations plus précises de la moyenne d'une strate peuvent être obtenues à partir d'un petit échantillon dans cette strate" (Cochran , 1977, p.89)[^fn1]. Dans le tutoriel CODED, une carte a été produite qui classait le paysage en forêt perturbée, forêt stable et non-forêt. Si nous sommes intéressés par une estimation de la superficie de la perturbation de la forêt, en utilisant la carte que nous avons produite - à condition qu'elle soit précise - nous devrions pouvoir produire une estimation précise à partir d'un échantillon relativement petit dans cette strate.

Lorsqu'on utilise une carte pour stratifier la région étudiée dans le cadre d'un échantillonnage aléatoire stratifié, il est courant et pratique de présenter les résultats de l'échantillon dans une matrice d'erreurs (également appelée matrice de confusion ou de contingence). Une matrice d'erreurs est un tableau croisé des observations de référence et des étiquettes de la carte aux emplacements de l'échantillon. Il existe plusieurs façons de créer une matrice d'erreurs. Par exemple, considérez la feuille de calcul suivante, créée dans le cadre du tutoriel sur la sélection d'échantillons ; les labels cartographiques des unités d'échantillonnage figurent dans la colonne des cartes, et supposons que nous ayons collecté des observations de référence, enregistrées dans la colonne des références: [Lien Feuille de Calcul](https://docs.google.com/spreadsheets/d/1-Z2LmLmwfxlVHwezO9N74P7GjfN_y0gjxUblKTfmCc8/edit?usp=sharing)

Les codes sont les suivants 1 : Forêt stable 2 : Non-forêt stable 3 : perturbation de forêt 4 : Tampon dans la forêt autour de la perturbation de forêt

Sur les lignes 1 à 8 et les colonnes E à K, créez la matrice suivante :

|      | A    | B    | C    | D    | E        | F          | G       | H          | I         | J      | K     | L    |
| ---- | ---- | ---- | ---- | ---- | -------- | ---------- | ------- | ---------- | --------- | ------ | ----- | ---- |
| 1    | ID   | Map  | Ref. |      | *Sample* | *count*    | *error* | *matrix*   |           |        |       |      |
| 2    | 1    | 1    | 1    |      |          |            | R       | E          | F.        |        |       |      |
| 3    | 2    | 1    | 1    |      |          |            | Forest  | Non-forest | For. Dis. | Buffer | Total | *Wh* |
| 4    | 3    | 4    | 1    |      | M        | Forest     |         |            |           |        |       |      |
| 5    | 4    | 3    | 3    |      | A        | Non-forest |         |            |           |        |       |      |
| 6    | 5    | 1    | 1    |      | P        | For. Dis.  |         |            |           |        |       |      |
| 7    | 6    | 2    | 2    |      |          | Buffer     |         |            |           |        |       |      |
| 8    | 7    | 1    | 1    |      |          | Total      |         |            |           |        |       |      |

Premièrement, ajoutez les poids des strates du tutoriel sur le plan d'échantillonnage (0,551, 0,407, 0,0137, 0,0287). Dans la cellule G4, nous voulons maintenant calculer le nombre d'unités de l'échantillon que nous avons cartographiées comme forêt et également observées comme forêt dans les données de référence -- nous le faisons avec l'expression suivante : "=countifs(B1:B536,"1",C1:C536,"1")". Refaites le calcul pour les non-forêts dans la cellule H5, mais changez le "1" en "2" ; puis à nouveau dans les cellules I6 et J7. Dans la cellule H4, nous voulons calculer le nombre d'unités d'échantillonnage qui ont été cartographiées comme étant de la forêt mais observées comme étant non forestières dans les données de référence -- spécifiez dans la cellule H4 "=countifs(B1:B536, "1",C1:C536, "2")". Refaites le calcul pour toutes les cellules restantes en modifiant le code en fonction de la position de la cellule ; et additionnez les totaux. Cela devrait donner la matrice suivante :

|      | A    | B    | C    | D    | E        | F          | G      | H          | I         | J      | K     | L      |
| ---- | ---- | ---- | ---- | ---- | -------- | ---------- | ------ | ---------- | --------- | ------ | ----- | ------ |
| 1    | ID   | Map  | Ref. |      | *Error*  | *matrix*   |        |            |           |        |       |        |
| 2    | 1    | 1    | 1    |      | *sample* | *counts*   | R      | E          | F.        |        |       |        |
| 3    | 2    | 1    | 1    |      |          |            | Forest | Non-forest | For. Dis. | Buffer | Total | *Wh*   |
| 4    | 3    | 4    | 1    |      | M        | Forest     | 271    | 3          | 1         | 0      | 275   | 0.551  |
| 5    | 4    | 3    | 3    |      | A        | Non-forest | 6      | 193        | 1         | 0      | 200   | 0.407  |
| 6    | 5    | 1    | 1    |      | P        | For. Dis.  | 2      | 1          | 27        | 0      | 30    | 0.0137 |
| 7    | 6    | 2    | 2    |      |          | Buffer     | 23     | 0          | 7         | 0      | 30    | 0.0287 |
| 8    | 7    | 1    | 1    |      |          | Total      | 302    | 197        | 36        | 0      | 535   | 1      |

Quelques éléments intéressants à noter ici : il n'y a pas d'observations de référence pour la zone tampon car nous n'observons évidemment pas les unités comme étant "tampon". Il est important de noter que nous avons maintenant estimé le nombre d'erreurs dans la carte : nous avons une erreur pour chaque perturbation forestière omise dans les strates forestières et non forestières, et sept dans la strate tampon. Nous avons également deux erreurs plus une de perturbation de forêt engagée.

Parce que nous avons échantillonné la Colombie selon un échantillonnage aléatoire stratifié, la moyenne n'est plus un estimateur sans biais de la moyenne de la population, sauf si nous devons tenir compte des poids des strates. Il est donc plus utile d'exprimer la matrice d'erreurs sous forme de proportions de zones plutôt que de nombres d'échantillons. Pour ce faire, copiez la matrice d'erreurs sur la ligne 10 mais laissez les cellules vides :

|      | A    | B    | C    | D    | E       | F             | G      | H          | I         | J      | K     | L      |
| ---- | ---- | ---- | ---- | ---- | ------- | ------------- | ------ | ---------- | --------- | ------ | ----- | ------ |
| 9    | 8    | 2    | 2    |      |         |               |        |            |           |        |       |        |
| 10   | 9    | 2    | 2    |      | *Error* | *matrix*      |        |            |           |        |       |        |
| 11   | 10   | 2    | 2    |      | *area*  | *proportions* | R      | E          | F.        |        |       |        |
| 12   | 11   | 3    | 3    |      |         |               | Forest | Non-forest | For. Dis. | Buffer | Total | *Wh*   |
| 13   | 12   | 1    | 1    |      | M       | Forest        |        |            |           |        |       | 0.551  |
| 14   | 13   | 1    | 1    |      | A       | Non-forest    |        |            |           |        |       | 0.407  |
| 15   | 14   | 1    | 1    |      | P       | For. Dis.     |        |            |           |        |       | 0.0137 |
| 16   | 15   | 2    | 2    |      |         | Buffer        |        |            |           |        |       | 0.0287 |
| 17   | 16   | 3    | 3    |      |         | Total         |        |            |           |        |       | 1      |

The estimated area proportions of a cell belonging to stratum *h* and observed in the reference data as *j* is (*h+* denotes a sum across columns; hence, *nh+* means the sample size allocated to stratum *h*)

Les proportions de surface estimées d'une cellule appartenant à la strate *h* et observées dans les données de référence en tant que *j* sont (*h+* désigne une somme entre les colonnes ; par conséquent, *nh+* signifie la taille de l'échantillon alloué à la strate *h*)

[![img](https://camo.githubusercontent.com/8114430fcfeb669d64ee2d62542e599a957d120a573e279309a8352e52a65de6/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f2535434c617267652673706163653b253543686174253742702537445f253742686a2537442673706163653b3d2673706163653b575f682673706163653b253543667261632537426e5f253742686a2537442537442537426e5f253742682b253744253744)](https://camo.githubusercontent.com/8114430fcfeb669d64ee2d62542e599a957d120a573e279309a8352e52a65de6/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f2535434c617267652673706163653b253543686174253742702537445f253742686a2537442673706163653b3d2673706163653b575f682673706163653b253543667261632537426e5f253742686a2537442537442537426e5f253742682b253744253744)

To estimate the area proportions, type in G13: "=$L12*G4/$K4" and expand to J13. Redo the calculation for the rows, which should give the following matrix:

|      | A    | B    | C    | D    | E       | F             | G       | H          | I         | J      | K       | L      |
| ---- | ---- | ---- | ---- | ---- | ------- | ------------- | ------- | ---------- | --------- | ------ | ------- | ------ |
| 9    | 8    | 2    | 2    |      |         |               |         |            |           |        |         |        |
| 10   | 9    | 2    | 2    |      | *Error* | *matrix*      |         |            |           |        |         |        |
| 11   | 10   | 2    | 2    |      | *area*  | *proportions* | R       | E          | F.        |        |         |        |
| 12   | 11   | 3    | 3    |      |         |               | Forest  | Non-forest | For. Dis. | Buffer | Total   | *Wh*   |
| 13   | 12   | 1    | 1    |      | M       | Forest        | 0.54299 | 0.00601    | 0.00200   | 0      | 0.55100 | 0.551  |
| 14   | 13   | 1    | 1    |      | A       | Non-forest    | 0.01221 | 0.39276    | 0.00204   | 0      | 0.40700 | 0.407  |
| 15   | 14   | 1    | 1    |      | P       | For. Dis.     | 0.00091 | 0.00046    | 0.01233   | 0      | 0.01370 | 0.0137 |
| 16   | 15   | 2    | 2    |      |         | Buffer        | 0.02200 | 0          | 0.00670   | 0      | 0.02870 | 0.0287 |
| 17   | 16   | 3    | 3    |      |         | Total         | 0.57811 | 0.39922    | 0.02307   | 0      | 1       | 1      |

Si nous avons effectué les calculs correctement, les totaux des lignes doivent être égaux aux poids des strates, car il s'agit des proportions de surface estimées des strates. Avec la matrice d'erreur exprimée en proportions de surface, nous pouvons facilement appliquer un estimateur stratifié pour estimer la surface de chaque catégorie. (Cochran, 1977, Eq. 5.52)[^fn1] :

[![img](https://camo.githubusercontent.com/46b9bb2556cb3a3bc3700b3926501427dd88364e25a7ebe11818f9094b91ef5f/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f2535434c617267652673706163653b2535436861742537422535436d752537445f2537426a2537443d253543686174253742702537445f2537422b6a2537442673706163653b3d2673706163653b25354373756d5f253742683d31253744253545482673706163653b575f682673706163653b253543667261632537426e5f253742686a2537442537442537426e5f253742682b253744253744)](https://camo.githubusercontent.com/46b9bb2556cb3a3bc3700b3926501427dd88364e25a7ebe11818f9094b91ef5f/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f2535434c617267652673706163653b2535436861742537422535436d752537445f2537426a2537443d253543686174253742702537445f2537422b6a2537442673706163653b3d2673706163653b25354373756d5f253742683d31253744253545482673706163653b575f682673706163653b253543667261632537426e5f253742686a2537442537442537426e5f253742682b253744253744)

Dans la matrice d'erreur des proportions estimées de la zone, les estimations stratifiées sont égales aux totaux des colonnes. Par conséquent,

[![img](https://camo.githubusercontent.com/9c420236f0fb6df3d8bf7f03bf3366674a2b996ebfeb95803c1603178c9773c4/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f2535434c617267652673706163653b2535436861742537422535436d752537445f253742312537443d302e3537383b2535436861742537422535436d752537445f253742322537443d302e3339393b2535436861742537422535436d752537445f253742332537443d302e323331)](https://camo.githubusercontent.com/9c420236f0fb6df3d8bf7f03bf3366674a2b996ebfeb95803c1603178c9773c4/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f2535434c617267652673706163653b2535436861742537422535436d752537445f253742312537443d302e3537383b2535436861742537422535436d752537445f253742322537443d302e3339393b2535436861742537422535436d752537445f253742332537443d302e323331)

Nous devons maintenant appliquer un estimateur de variance stratifié pour construire un intervalle de confiance à 95% autour des estimations. L'estimateur de la variance stratifiée est(Cochran, 1977, Eq. 5.57)

[![img](https://camo.githubusercontent.com/74d28e38dad426b7ac369d2f1218afd12b619014bc37f4440ebab91d3f1bbf58/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f2535434c617267652673706163653b25354368617425374256253744282535436861742537422535436d752537445f2537426a253744293d25354373756d5f253742683d31253744253545482673706163653b575f68253545322673706163653b25354366726163253742253543667261632537426e5f253742686a2537442537442537426e5f253742682b25374425374428312d253543667261632537426e5f253742686a2537442537442537426e5f253742682b253744253744292537442537426e5f253742682b2537442d312537443d25354373756d5f253742683d31253744253545482673706163653b25354366726163253742575f68253543686174253742702537445f253742686a2537442d253543686174253742702537445f253742686a253744253545322537442537426e5f253742682b2537442d31253744)](https://camo.githubusercontent.com/74d28e38dad426b7ac369d2f1218afd12b619014bc37f4440ebab91d3f1bbf58/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f2535434c617267652673706163653b25354368617425374256253744282535436861742537422535436d752537445f2537426a253744293d25354373756d5f253742683d31253744253545482673706163653b575f68253545322673706163653b25354366726163253742253543667261632537426e5f253742686a2537442537442537426e5f253742682b25374425374428312d253543667261632537426e5f253742686a2537442537442537426e5f253742682b253744253744292537442537426e5f253742682b2537442d312537443d25354373756d5f253742683d31253744253545482673706163653b25354366726163253742575f68253543686174253742702537445f253742686a2537442d253543686174253742702537445f253742686a253744253545322537442537426e5f253742682b2537442d31253744)

Pour appliquer l'estimateur de variance aux résultats de l'échantillon dans la matrice d'erreurs, tapez dans la cellule F17 "V(*μ*)" et en G17 "=($L12*G12-G12^2)/($K4-1) + ($L13*G13-G13^2)/($K5-1) + ($L14*G14-G14^2)/($K6-1) + ($L15*G15-G15^2)/($K7-1)" et étendre à J18.

Tapez maintenant "SE(*μ*)" idans la cellule F18 pour calculer l'erreur standard ; dans la cellule G18, tapez "=sqrt(G17)" et élargissez à J18. Tapez ensuite "±95% CI" dans la cellule F19 et dans la cellule G19 tapez "=G18*1.96" et étendez à J19. Enfin, tapez "MoE [%]" dans la cellule F20 et dans la cellule G20 tapez "=G19/G16" aet développez jusqu'à I20, et convertissez les cellules G à I de la ligne 20 en pourcentage. Cela devrait donner le résultat suivant :

|      | A    | B    | C    | D    | E    | F       | G         | H         | I         | J    | K    | L    |
| ---- | ---- | ---- | ---- | ---- | ---- | ------- | --------- | --------- | --------- | ---- | ---- | ---- |
| 16   | 15   | 2    | 2    |      |      | Total   | 0.57811   | 0.39922   | 0.02307   | 0    | 1    | 1    |
| 17   | 16   | 3    | 3    |      |      | V(μ)    | 0.0000456 | 0.0000403 | 0.0000138 | 0    |      |      |
| 18   | 17   | 1    | 2    |      |      | SE(μ)   | 0.0067520 | 0.0063466 | 0.0037174 | 0    |      |      |
| 19   | 18   | 2    | 2    |      |      | ±95% CI | 0.0132339 | 0.0124393 | 0.0072862 | 0    |      |      |
| 20   | 19   | 4    | 1    |      |      | MoE [%] | 2.29%     | 3.12%     | 31.59%    | 0    |      |      |

Ceci conclut l'estimation stratifiée de la superficie (il s'agit de la proportion de la superficie et elle doit être multipliée par la superficie totale de la Colombie pour exprimer les estimations en unités de superficie) :

[![img](https://camo.githubusercontent.com/a89128f3a98d1ff3097d1182ad3c10639ed2270432305a5241368812fba6ff69/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f2535434c617267652673706163653b2535436861742537422535436d752537445f253742312537443d302e353738253543706d302e30313332)](https://camo.githubusercontent.com/a89128f3a98d1ff3097d1182ad3c10639ed2270432305a5241368812fba6ff69/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f2535434c617267652673706163653b2535436861742537422535436d752537445f253742312537443d302e353738253543706d302e30313332) [![img](https://camo.githubusercontent.com/405b6fe2a27fbcf5352c17c800588075580e8a9b32ace7bfd89cd1d78dacaef8/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f2535434c617267652673706163653b2535436861742537422535436d752537445f253742322537443d302e333939253543706d302e30313234)](https://camo.githubusercontent.com/405b6fe2a27fbcf5352c17c800588075580e8a9b32ace7bfd89cd1d78dacaef8/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f2535434c617267652673706163653b2535436861742537422535436d752537445f253742322537443d302e333939253543706d302e30313234) [![img](https://camo.githubusercontent.com/5efc5fed89bd58a06a46d0a482b26d663e43769abf253231c860eaeb225b19e4/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f2535434c617267652673706163653b2535436861742537422535436d752537445f253742332537443d302e323331253543706d302e30303732)](https://camo.githubusercontent.com/5efc5fed89bd58a06a46d0a482b26d663e43769abf253231c860eaeb225b19e4/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f2535434c617267652673706163653b2535436861742537422535436d752537445f253742332537443d302e323331253543706d302e30303732)

Enfin, calculons la précision de la carte et des classes de cartes, en commençant par la précision de l'utilisateur. Dans la cellule F21 Dans la cellule "User's acc." et en G21 "=G12/K12"; H21 "=H13/K13"; I21 "=I14/K14". Répétez à la ligne 22 avec les cellules G22 "=G12/G16"; H22 "=H13/H16"; I22 "=I14/I16". Ajoutez la précision globale à la ligne 23 comme "=sum(G12,H13,I14)". Cela devrait donner ce qui suit :

|      | A    | B    | C    | D    | E    | F           | G         | H         | I         | J    | K    | L    |
| ---- | ---- | ---- | ---- | ---- | ---- | ----------- | --------- | --------- | --------- | ---- | ---- | ---- |
| 16   | 15   | 2    | 2    |      |      | Total       | 0.57811   | 0.39922   | 0.02307   | 0    | 1    | 1    |
| 17   | 16   | 3    | 3    |      |      | V(μ)        | 0.0000456 | 0.0000403 | 0.0000138 | 0    |      |      |
| 18   | 17   | 1    | 2    |      |      | SE(μ)       | 0.0067520 | 0.0063466 | 0.0037174 | 0    |      |      |
| 19   | 18   | 2    | 2    |      |      | ±95% CI     | 0.0132339 | 0.0124393 | 0.0072862 | 0    |      |      |
| 20   | 19   | 4    | 1    |      |      | MoE [%]     | 2.29%     | 3.12%     | 31.59%    | 0    |      |      |
| 21   | 20   | 3    | 3    |      |      | User's acc. | 0.985     | 0.965     | 0.900     | 0    |      |      |
| 22   | 21   | 3    | 3    |      |      | Prod. acc.  | 0.939     | 0.984     | 0.535     | 0    |      |      |
| 23   | 22   | 2    | 2    |      |      | Over. acc.  | 0.948     |           |           |      |      |      |

## 4. Estimation de la précision d'une carte différente de la stratification initiale

Lorsque les résultats de l'échantillon ont été collectés à l'aide d'une stratification différente de la carte que nous voulons utiliser pour l'évaluation de la précision, nous ne pouvons pas appliquer les estimateurs stratifiés classiques illustrés ci-dessus, car ils sont biaisés lorsque les lignes de la matrice d'erreur de la population ne correspondent pas aux strates utilisées pour sélectionner l'échantillon. Au lieu de cela, nous devons construire des estimateurs de ratio en utilisant des fonctions indicatrices (Stehman, 2014)[^fn4]. Pour simplifier, réduisons les résultats de notre échantillon à deux classes d'observations de référence : *h* = 1 est la perturbation de la forêt et *h* = 2 est la non perturbation ; et en outre, que nous avons construit une nouvelle carte de perturbation et de non perturbation.

Pour estimer la précision globale de la nouvelle carte en utilisant les résultats de notre échantillon existant, définissez les variables suivantes

[![img](https://camo.githubusercontent.com/0b062c909ae0a4d03b538e70a5d9d3aaca5329394cd71cdeadfb6334a8e410ce/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f795f752535454f253230253344253230253543626567696e253742636173657325374425323031253230253236253230253543746578742537426966253230756e6974253230253543746578746974253742752537442532306973253230636c6173736966696564253230636f72726563746c7925374425354325354325323030253230253236253230253543746578742537426966253230756e6974253230253543746578746974253742752537442532306973253230636c6173736966696564253230696e636f72726563746c79253744253230253543656e642537426361736573253744)](https://camo.githubusercontent.com/0b062c909ae0a4d03b538e70a5d9d3aaca5329394cd71cdeadfb6334a8e410ce/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f795f752535454f253230253344253230253543626567696e253742636173657325374425323031253230253236253230253543746578742537426966253230756e6974253230253543746578746974253742752537442532306973253230636c6173736966696564253230636f72726563746c7925374425354325354325323030253230253236253230253543746578742537426966253230756e6974253230253543746578746974253742752537442532306973253230636c6173736966696564253230696e636f72726563746c79253744253230253543656e642537426361736573253744)

La précision globale la moyenne de population [![img](https://camo.githubusercontent.com/e143d4ee44f3308cbaa21684162b336c59f9d2ab74d8966a0c88b2a1d5cb1f74/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543696e6c696e6525323025354364706925374231303025374425323025354362617225374259253744)](https://camo.githubusercontent.com/e143d4ee44f3308cbaa21684162b336c59f9d2ab74d8966a0c88b2a1d5cb1f74/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543696e6c696e6525323025354364706925374231303025374425323025354362617225374259253744) basée sur un recensement de N pixels dans la région ; [![img](https://camo.githubusercontent.com/e143d4ee44f3308cbaa21684162b336c59f9d2ab74d8966a0c88b2a1d5cb1f74/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543696e6c696e6525323025354364706925374231303025374425323025354362617225374259253744)](https://camo.githubusercontent.com/e143d4ee44f3308cbaa21684162b336c59f9d2ab74d8966a0c88b2a1d5cb1f74/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543696e6c696e6525323025354364706925374231303025374425323025354362617225374259253744) iest équivalent à la proportion de pixels correctement classés, c'est-à-dire la précision globale. Un estimateur sans biais de [![img](https://camo.githubusercontent.com/e143d4ee44f3308cbaa21684162b336c59f9d2ab74d8966a0c88b2a1d5cb1f74/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543696e6c696e6525323025354364706925374231303025374425323025354362617225374259253744)](https://camo.githubusercontent.com/e143d4ee44f3308cbaa21684162b336c59f9d2ab74d8966a0c88b2a1d5cb1f74/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543696e6c696e6525323025354364706925374231303025374425323025354362617225374259253744) est le suivant

[![img](https://camo.githubusercontent.com/c4544adc91e201c50eeec4034898d38b1395f406360b8ade1e1fdda908fba7f3/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f2535436861742537424f253744253230253344253230253543686174253742253543626172253742592537442537442532302533442532302535436672616325374225354373756d2532304e5f682535452a253230253543626172253742792537445f682535454f2537442537424e253744253230253344253230253543667261632537424e5f312535452a253230253543626172253742792537445f312535454f2537442537424e2537442532302b253230253543667261632537422532304e5f322535452a253230253543626172253742792537445f322535454f2537442537424e25374425323025334425323025354366726163253742312537442537424e2537442532302532384e5f312535452a25323025354373756d5f25374275253230253543696e253230682533443125374425323025354366726163253742795f752535454f2537442537426e5f312535452a2537442532302b2532304e5f322535452a25323025354373756d5f25374275253230253543696e253230682533443225374425323025354366726163253742795f752535454f2537442537426e5f322535452a253744253239)](https://camo.githubusercontent.com/c4544adc91e201c50eeec4034898d38b1395f406360b8ade1e1fdda908fba7f3/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f2535436861742537424f253744253230253344253230253543686174253742253543626172253742592537442537442532302533442532302535436672616325374225354373756d2532304e5f682535452a253230253543626172253742792537445f682535454f2537442537424e253744253230253344253230253543667261632537424e5f312535452a253230253543626172253742792537445f312535454f2537442537424e2537442532302b253230253543667261632537422532304e5f322535452a253230253543626172253742792537445f322535454f2537442537424e25374425323025334425323025354366726163253742312537442537424e2537442532302532384e5f312535452a25323025354373756d5f25374275253230253543696e253230682533443125374425323025354366726163253742795f752535454f2537442537426e5f312535452a2537442532302b2532304e5f322535452a25323025354373756d5f25374275253230253543696e253230682533443225374425323025354366726163253742795f752535454f2537442537426e5f322535452a253744253239)

Pour la précision de l'utilisateur de la nouvelle carte, définissez les deux variables suivantes

[![img](https://camo.githubusercontent.com/e052ddcae5e8f99f2af02165ec53ec8e894a68a3f28e11358898ab7af1c1c14d/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f795f7525354555253230253344253230253543626567696e253742636173657325374425323031253230253236253230253543746578742537426966253230756e6974253230253543746578746974253742752537442532306973253230636c6173736966696564253230636f72726563746c79253230616e642532306d6170253230636c617373253230666f72657374253230646973742e25374425354325354325323030253230253236253230253543746578742537426f7468657277697365253342253744253230253543656e642537426361736573253744253230)](https://camo.githubusercontent.com/e052ddcae5e8f99f2af02165ec53ec8e894a68a3f28e11358898ab7af1c1c14d/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f795f7525354555253230253344253230253543626567696e253742636173657325374425323031253230253236253230253543746578742537426966253230756e6974253230253543746578746974253742752537442532306973253230636c6173736966696564253230636f72726563746c79253230616e642532306d6170253230636c617373253230666f72657374253230646973742e25374425354325354325323030253230253236253230253543746578742537426f7468657277697365253342253744253230253543656e642537426361736573253744253230)

[![img](https://camo.githubusercontent.com/41c2101f8cad7329ae3a8e99bf81e437a3ea25cac7c0184cc9c44bbea41ff32a/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f785f7525354555253230253344253230253543626567696e253742636173657325374425323031253230253236253230253543746578742537426966253230756e69742532302535437465787469742537427525374425323069732532306d6170253230636c617373253230666f72657374253230646973742e25374425354325354325323030253230253236253230253543746578742537426f74686572776973652e253744253230253543656e642537426361736573253744)](https://camo.githubusercontent.com/41c2101f8cad7329ae3a8e99bf81e437a3ea25cac7c0184cc9c44bbea41ff32a/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f785f7525354555253230253344253230253543626567696e253742636173657325374425323031253230253236253230253543746578742537426966253230756e69742532302535437465787469742537427525374425323069732532306d6170253230636c617373253230666f72657374253230646973742e25374425354325354325323030253230253236253230253543746578742537426f74686572776973652e253744253230253543656e642537426361736573253744)

and for producer's accuracy:

[![img](https://camo.githubusercontent.com/0864d1be4a4e15a66c356607c7fbf556ccf7bb4a1bb6210beaa09f99f71c661b/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f795f7525354550253230253344253230253543626567696e253742636173657325374425323031253230253236253230253543746578742537426966253230756e6974253230253234752532342532306973253230636f72726563746c79253230636c6173736966696564253230616e642532307265666572656e6365253230636c617373253230666f72657374253230646973742e25374425354325354325323030253230253236253230253543746578742537426f7468657277697365253342253744253230253543656e642537426361736573253744)](https://camo.githubusercontent.com/0864d1be4a4e15a66c356607c7fbf556ccf7bb4a1bb6210beaa09f99f71c661b/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f795f7525354550253230253344253230253543626567696e253742636173657325374425323031253230253236253230253543746578742537426966253230756e6974253230253234752532342532306973253230636f72726563746c79253230636c6173736966696564253230616e642532307265666572656e6365253230636c617373253230666f72657374253230646973742e25374425354325354325323030253230253236253230253543746578742537426f7468657277697365253342253744253230253543656e642537426361736573253744)

[![img](https://camo.githubusercontent.com/e73740da60f2b37ce8230442fac0e73ec4df638b131ae799aa1ffe1557dc2176/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f785f7525354550253230253344253230253543626567696e253742636173657325374425323031253230253236253230253543746578742537426966253230756e69742532302535437465787469742537427525374425323069732532307265666572656e6365253230636c617373253230666f72657374253230646973742e25374425354325354325323030253230253236253230253543746578742537426f74686572776973652e253744253230253543656e642537426361736573253744)](https://camo.githubusercontent.com/e73740da60f2b37ce8230442fac0e73ec4df638b131ae799aa1ffe1557dc2176/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f785f7525354550253230253344253230253543626567696e253742636173657325374425323031253230253236253230253543746578742537426966253230756e69742532302535437465787469742537427525374425323069732532307265666572656e6365253230636c617373253230666f72657374253230646973742e25374425354325354325323030253230253236253230253543746578742537426f74686572776973652e253744253230253543656e642537426361736573253744)

Nous pouvons maintenant estimer la précision de l'utilisateur et du producteur de la classe de perturbation de forêt en utilisant un estimateur de ratio avec les moyennes de *x* et *y* spécifiques à la strate :

[![img](https://camo.githubusercontent.com/762cf0874c98bfb5d6ca69ea705e8f734f85edb2db6435b70033c852feccb3ac/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543686174253742522537442532302533442532302535436672616325374225354368617425374259253744253744253742253543686174253742582537442537442532302533442532302535436672616325374225354373756d5f2537426825334431253744253545482532304e5f682535452a253230253543626172253742792537445f6825374425374225354373756d5f2537426825334431253744253545482532304e5f682535452a253230253543626172253742782537445f68253744)](https://camo.githubusercontent.com/762cf0874c98bfb5d6ca69ea705e8f734f85edb2db6435b70033c852feccb3ac/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543686174253742522537442532302533442532302535436672616325374225354368617425374259253744253744253742253543686174253742582537442537442532302533442532302535436672616325374225354373756d5f2537426825334431253744253545482532304e5f682535452a253230253543626172253742792537445f6825374425374225354373756d5f2537426825334431253744253545482532304e5f682535452a253230253543626172253742782537445f68253744)

Notez que [![img](https://camo.githubusercontent.com/8bd0db05a1fdb433198f6b1b931d6d0faef7e720e2eb3438ad1b4091d67ffc09/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543696e6c696e652532302535436470692537423130302537442532304e5f682535452a)](https://camo.githubusercontent.com/8bd0db05a1fdb433198f6b1b931d6d0faef7e720e2eb3438ad1b4091d67ffc09/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543696e6c696e652532302535436470692537423130302537442532304e5f682535452a) est la taille de la population et [![img](https://camo.githubusercontent.com/c54cadef88e203c9cc2c2fa717da19928abc0331143d9e2c9d7b6e9593889235/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543696e6c696e652532302535436470692537423130302537442532306e5f682535452a)](https://camo.githubusercontent.com/c54cadef88e203c9cc2c2fa717da19928abc0331143d9e2c9d7b6e9593889235/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543696e6c696e652532302535436470692537423130302537442532306e5f682535452a) celle de l'échantillon dans les résultats de l'échantillon, par opposition à la [![img](https://camo.githubusercontent.com/97f4a17bf87471f2bdf29f7565c861bf3f49ef19fc000f213db6c397370bf4c5/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543696e6c696e652532302535436470692537423130302537442532304e5f68)](https://camo.githubusercontent.com/97f4a17bf87471f2bdf29f7565c861bf3f49ef19fc000f213db6c397370bf4c5/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543696e6c696e652532302535436470692537423130302537442532304e5f68) taille de la population et [![img](https://camo.githubusercontent.com/7964e24db2838afd013d6c00b64a3cef460a52aba938d9f570c811dd8d330be4/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543696e6c696e652532302535436470692537423130302537442532306e5f68)](https://camo.githubusercontent.com/7964e24db2838afd013d6c00b64a3cef460a52aba938d9f570c811dd8d330be4/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543696e6c696e652532302535436470692537423130302537442532306e5f68) staille de l'échantillon dans la nouvelle carte. En comptant les *x* et *y* dans la nouvelle carte, nous calculons le nombre d'échantillons pour remplir la matrice d'erreurs suivante :

[![img](https://camo.githubusercontent.com/4cc5635a86346652a64dd1291257e40274fe79e3138dd2e1f1ae39b49e94926f/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543647069253742313230253744253230253543626567696e253742746162756c61722537442537422532306c253230632532306325323063253230632537442532305374726174756d253230253236253230253234253543626172253742792537445f7525354555253234253230253236253230253234253543626172253742782537445f7525354555253234253230253236253230253234253543626172253742792537445f7525354550253234253230253236253230253234253543626172253742782537445f7525354550253234253230253543253543253230253543686c696e65253230312e253230466f72657374253230446973742e2532302532362532302532342535436672616325374225354373756d253230795f75253545552537442537426e5f312535452a2537442532342532302532362532302532342535436672616325374225354373756d253230785f75253545552537442537426e5f312535452a2537442532342532302532362532302532342535436672616325374225354373756d253230795f75253545502537442537426e5f312535452a2537442532342532302532362532302532342535436672616325374225354373756d253230785f75253545502537442537426e5f312535452a253744253234253543253543253230322e2532304e6f6e2d446973742e2532302532362532302532342535436672616325374225354373756d253230795f75253545552537442537426e5f322535452a2537442532342532302532362532302532342535436672616325374225354373756d253230785f75253545552537442537426e5f322535452a2537442532342532302532362532302532342535436672616325374225354373756d253230795f75253545502537442537426e5f322535452a2537442532342532302532362532302532342535436672616325374225354373756d253230785f75253545502537442537426e5f322535452a253744253234253230253543656e64253742746162756c6172253744)](https://camo.githubusercontent.com/4cc5635a86346652a64dd1291257e40274fe79e3138dd2e1f1ae39b49e94926f/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543647069253742313230253744253230253543626567696e253742746162756c61722537442537422532306c253230632532306325323063253230632537442532305374726174756d253230253236253230253234253543626172253742792537445f7525354555253234253230253236253230253234253543626172253742782537445f7525354555253234253230253236253230253234253543626172253742792537445f7525354550253234253230253236253230253234253543626172253742782537445f7525354550253234253230253543253543253230253543686c696e65253230312e253230466f72657374253230446973742e2532302532362532302532342535436672616325374225354373756d253230795f75253545552537442537426e5f312535452a2537442532342532302532362532302532342535436672616325374225354373756d253230785f75253545552537442537426e5f312535452a2537442532342532302532362532302532342535436672616325374225354373756d253230795f75253545502537442537426e5f312535452a2537442532342532302532362532302532342535436672616325374225354373756d253230785f75253545502537442537426e5f312535452a253744253234253543253543253230322e2532304e6f6e2d446973742e2532302532362532302532342535436672616325374225354373756d253230795f75253545552537442537426e5f322535452a2537442532342532302532362532302532342535436672616325374225354373756d253230785f75253545552537442537426e5f322535452a2537442532342532302532362532302532342535436672616325374225354373756d253230795f75253545502537442537426e5f322535452a2537442532342532302532362532302532342535436672616325374225354373756d253230785f75253545502537442537426e5f322535452a253744253234253230253543656e64253742746162756c6172253744)

qui permet d'utiliser facilement l'estimateur de ratio pour l'estimation de la précision de l'utilisateur et du producteur de la nouvelle classe de perturbation de la forêt ([![img](https://camo.githubusercontent.com/802b7657a83864707ca6eae7f201eb44643967a6f432b6d72a02e76d621368df/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543696e6c696e65253230253543647069253742313030253744253230555f31)](https://camo.githubusercontent.com/802b7657a83864707ca6eae7f201eb44643967a6f432b6d72a02e76d621368df/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543696e6c696e65253230253543647069253742313030253744253230555f31) and [![img](https://camo.githubusercontent.com/5f391a195f4e94ead799dbbb801d73eafc1851bb18b358458b21fc0ca3490ed0/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543696e6c696e65253230253543647069253742313030253744253230505f31)](https://camo.githubusercontent.com/5f391a195f4e94ead799dbbb801d73eafc1851bb18b358458b21fc0ca3490ed0/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543696e6c696e65253230253543647069253742313030253744253230505f31)):

[![img](https://camo.githubusercontent.com/cc6fd5ed438872792d4034bda6a528621357c2a30ace146041725c620ac7a1a1/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543647069253742313230253744253230253543686174253742552537445f312532302533442532302535436861742537425225374425323025334425323025354366726163253742253543667261632537424e5f312535452a2537442537426e5f312535452a25374425323025354373756d5f25374275253230253543696e2532306825334431253744253230795f75253545552532302b253230253543667261632537424e5f322535452a2537442537426e5f322535452a25374425323025354373756d5f25374275253230253543696e2532306825334432253744253230795f7525354555253744253742253543667261632537424e5f312535452a2537442537426e5f312535452a25374425323025354373756d5f25374275253230253543696e2532306825334431253744253230785f75253545552532302b253230253543667261632537424e5f322535452a2537442537426e5f322535452a25374425323025354373756d5f25374275253230253543696e2532306825334432253744253230785f7525354555253744)](https://camo.githubusercontent.com/cc6fd5ed438872792d4034bda6a528621357c2a30ace146041725c620ac7a1a1/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543647069253742313230253744253230253543686174253742552537445f312532302533442532302535436861742537425225374425323025334425323025354366726163253742253543667261632537424e5f312535452a2537442537426e5f312535452a25374425323025354373756d5f25374275253230253543696e2532306825334431253744253230795f75253545552532302b253230253543667261632537424e5f322535452a2537442537426e5f322535452a25374425323025354373756d5f25374275253230253543696e2532306825334432253744253230795f7525354555253744253742253543667261632537424e5f312535452a2537442537426e5f312535452a25374425323025354373756d5f25374275253230253543696e2532306825334431253744253230785f75253545552532302b253230253543667261632537424e5f322535452a2537442537426e5f322535452a25374425323025354373756d5f25374275253230253543696e2532306825334432253744253230785f7525354555253744)

[![img](https://camo.githubusercontent.com/991f9011e62f3b60f85051fdb0e1d2a72ba9818e24e58ee5a1b8eaba46507c0e/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543647069253742313230253744253230253543686174253742502537445f312532302533442532302535436861742537425225374425323025334425323025354366726163253742253543667261632537424e5f312535452a2537442537426e5f312535452a25374425323025354373756d5f25374275253230253543696e2532306825334431253744253230795f75253545502532302b253230253543667261632537424e5f322535452a2537442537426e5f322535452a25374425323025354373756d5f25374275253230253543696e2532306825334432253744253230795f7525354550253744253742253543667261632537424e5f312535452a2537442537426e5f312535452a25374425323025354373756d5f25374275253230253543696e2532306825334431253744253230785f75253545502532302b253230253543667261632537424e5f322535452a2537442537426e5f322535452a25374425323025354373756d5f25374275253230253543696e2532306825334432253744253230785f7525354550253744)](https://camo.githubusercontent.com/991f9011e62f3b60f85051fdb0e1d2a72ba9818e24e58ee5a1b8eaba46507c0e/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543647069253742313230253744253230253543686174253742502537445f312532302533442532302535436861742537425225374425323025334425323025354366726163253742253543667261632537424e5f312535452a2537442537426e5f312535452a25374425323025354373756d5f25374275253230253543696e2532306825334431253744253230795f75253545502532302b253230253543667261632537424e5f322535452a2537442537426e5f322535452a25374425323025354373756d5f25374275253230253543696e2532306825334432253744253230795f7525354550253744253742253543667261632537424e5f312535452a2537442537426e5f312535452a25374425323025354373756d5f25374275253230253543696e2532306825334431253744253230785f75253545502532302b253230253543667261632537424e5f322535452a2537442537426e5f322535452a25374425323025354373756d5f25374275253230253543696e2532306825334432253744253230785f7525354550253744)

## 5. Post-stratification

Comme expliqué dans le tutoriel sur le plan d'échantillonnage, un avantage important du SRS/SYS est la possibilité de stratifier la zone d'étude après la collecte des résultats de l'échantillonnage. L'application d'une stratification après l'échantillonnage est appelée post-stratification (PSTR), ce qui est susceptible d'augmenter la précision des estimations, et il y a rarement des raisons de ne pas post-stratifier, à condition que des cartes existent sur la zone d'étude. Un autre avantage est que l'estimateur stratifié illustré à la section 3, **Estimation stratifiée** ci-dessus, est directement applicable aux données de l'échantillon SRS ou SYS lorsqu'il est croisé avec les étiquettes de la post-stratification dans une matrice d'erreurs (dans ce cas, l'estimateur stratifié est appelé estimateur post-stratifié mais la formule est exactement la même). Par conséquent, pour appliquer un estimateur PSTR, il suffit de suivre les étapes décrites dans la section 3, **Estimation stratifiée** ci-dessus.

Une différence importante entre l'estimation STR et PSTR est la formule de l'estimateur de la variance. Selon Lohr (1999, Eq. 4.22)[^fn5] si *Wh* est connu et que “*nh* est raisonnablement grand (≥30 environ)” - ou “raisonnablement grand, disons > 20 dans chaque strate” (Cochran 1977, p. 134)[^fn1] – l'estimateur de variance est

[![img](https://camo.githubusercontent.com/c7b79d353d65dbdf330ff14f9aa7a9a0d13949739cfc93762b97758dd228b2df/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f2535434c617267652673706163653b25354368617425374256253744282535436861742537422535436d752537445f2537425053545225374429253543617070726f7825354373756d5f253742683d31253744253545482673706163653b575f6825354366726163253742735f68253545322537442537426e5f25374268253744253744)](https://camo.githubusercontent.com/c7b79d353d65dbdf330ff14f9aa7a9a0d13949739cfc93762b97758dd228b2df/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f2535434c617267652673706163653b25354368617425374256253744282535436861742537422535436d752537445f2537425053545225374429253543617070726f7825354373756d5f253742683d31253744253545482673706163653b575f6825354366726163253742735f68253545322537442537426e5f25374268253744253744)

Pour les proportions (Cochran, 1977, Eq. 3.5)[^fn1], la variance de la strate *h* peut être exprimée comme suit

[![img](https://camo.githubusercontent.com/9638b45d3e8ee5c3c26f2aaf0812689bf5a0fca3ecf55d49e8a7dbcef596822f/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f2535434c617267652673706163653b735f68253545323d253543667261632537426e5f682537442537426e5f253742682537442d31253744705f6828312d705f6829)](https://camo.githubusercontent.com/9638b45d3e8ee5c3c26f2aaf0812689bf5a0fca3ecf55d49e8a7dbcef596822f/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f2535434c617267652673706163653b735f68253545323d253543667261632537426e5f682537442537426e5f253742682537442d31253744705f6828312d705f6829)

Dans une matrice d'erreur traditionnelle, *p_h = n_hj ÷ n_h* where *n_hj* iest le nombre d'échantillons de la classe de référence *j* dans la strate *h*. En combinant l'approximation de la variance de Lohr et l'expression de Cochran pour la variance de strate, on obtient un estimateur de variance post-stratifié exprimé à l'aide des éléments d'une matrice d'erreurs :

[![img](https://camo.githubusercontent.com/3cddb6035d0b21d331dfdfddefd571313412a19457ff09dfae3e0479abef37e4/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543686174253742562537442532382535436861742537422535436d752537445f25374250535452253744253239253543617070726f7825354373756d5f2537426825334431253744253545482532367370616365253342575f6825354366726163253742735f68253545322537442537426e5f2537426825374425374425334425354366726163253742312537442537426e25374425354373756d5f253742682533443125374425354548575f68253543667261632537426e5f682537442537426e5f682d31253744705f68253238312d705f6825323925334425354366726163253742312537442537426e25374425354373756d5f253742682533443125374425354548575f68253543667261632537426e5f253742686a253744253238312d253543667261632537426e5f253742686a2537442537442537426e5f253742682b2537442537442532392537442537426e5f253742682b2537442d31253744)](https://camo.githubusercontent.com/3cddb6035d0b21d331dfdfddefd571313412a19457ff09dfae3e0479abef37e4/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f253543686174253742562537442532382535436861742537422535436d752537445f25374250535452253744253239253543617070726f7825354373756d5f2537426825334431253744253545482532367370616365253342575f6825354366726163253742735f68253545322537442537426e5f2537426825374425374425334425354366726163253742312537442537426e25374425354373756d5f253742682533443125374425354548575f68253543667261632537426e5f682537442537426e5f682d31253744705f68253238312d705f6825323925334425354366726163253742312537442537426e25374425354373756d5f253742682533443125374425354548575f68253543667261632537426e5f253742686a253744253238312d253543667261632537426e5f253742686a2537442537442537426e5f253742682b2537442537442532392537442537426e5f253742682b2537442d31253744)

Si vous comparez cela à l'estimateur de variance STR Section 3, **Estimation stratifiée** ci-dessus, vous verrez que l'estimateur de variance PSTR est très similaire mais pas identique.

### 3.4  Logiciel pour automatiser l'analyse des résultats des échantillons

#### AREA2

L'application AREA2 de Google Earth Engine contient les équations de tous les estimateurs décrits dans ce tutoriel. Notez que dans AREA2, l'estimateur SRS est désigné par son nom officiel, l'estimateur d'expansion. AREA2 est disponible ici : [Lien application AREA2](https://code.earthengine.google.com/?accept_repo=projects/AREA2/public) et une documentation plus détaillée ici :[Lien documentation plus approfondie](https://area2.readthedocs.io/)

#### SEPAL

L'estimation stratifiée est automatisée dans SEPAL ; la documentation est disponible ici: https://github.com/sig-gis/SEPAL-CEO Faites défiler la page jusqu'à *Exercice 4.3 : Estimation de la surface et de l'incertitude* pour une description de l'estimation stratifiée.

## 4 Frequently Asked Questions (FAQs)

**I have seen in the literature that regression estimators have been used with sample data collected under stratified random sampling -- is the regression a more precise estimators than the STR estimator?**

A regression estimator -- often referred to as a model-assisted regression estimator when making of map data -- will yield the exact same estimates if applied to the sample data used in this tutorial. The regression variance estimator is slightly different and less precise in a situations where we have categorical map and reference observations. When the map and reference observation are expressed as proportions, the regression estimator is likely to be more precise. For an in-depth discussion of the different estimators when applied to an error matrix, see Stehman (2013).

**How do I know if I should post-stratify or not?**

If you have sample data collected under a simple design, there are several compelling reasons to post-stratify the study area. The main reason is that you are likely to obtain more precise estimates. Note that you will need a map though with a legend that corresponds to that of the sample data.

**I have an existing sample collected under STR that I now want to use to assess the accuracy of a map that was not used to define strata. I understand I need to the construct the indicator function-based estimator described above but they math is too complicated -- what do I do?**

Read Stehman (2013)! Consulting Steve Stehman's papers is always a good idea, especially in this case. Stehman (2013) provides a numerical example with test data that is easy to follow. The math will be feel much less intimidating after going trough Steve's example!

## 5 Terminologie relative aux techniques d'échantillonnage

Une liste de termes relatifs aux techniques d'échantillonnage et d'inférence est fournie dans la documentation d'AREA2 : https://area2.readthedocs.io/en/latest/definitions.html Vous trouverez ci-dessous quelques termes supplémentaires qui ne figurent pas dans la documentation d'AREA2.

### 5.1 Plan de réponse

Défini par (Stehman and Czaplewski, 1998)[^fn1]: “La référence ou classe réelle est obtenue pour chaque unité d'échantillonnage sur la base de l'interprétation de photographies aériennes ou de vidéographies, d'une observation au sol ou d'une combinaison de ces sources. Les méthodes utilisées pour déterminer cette référence de classification sont appelées "plan de réponse". Le plan d'intervention comprend les procédures de collecte des informations relatives à la détermination de la occupation du sol de référence, et les règles d'attribution d'une ou plusieurs [labels] de référence à chaque unité d'échantillonnage.” Connu sous le nom de “plan de mesure” par Särndal et al. (1992)[^fn2].

### 5.2 Echantillon

Un sous-ensemble de la population sélectionné parmi les unités de la population.

### 5.3 Plan d'échantillonnage

Synonyme de plan d'échantillonnage (Sampling Design), qui est le terme préféré dans la littérature de référence (Cochran, 1977[^fn3], Särndal et al., 1992[^fn2]). Le terme apparaît chez Rice (1995)[^fn4] ui utilise à la fois “sampling design, ***plan d'echantillonnage\***” et “sample design, ***plan d'echantillon\***”.

### 5.4 Plan d'échantillonnage

“Le concept de plan d'échantillonnage (sampling design ) est le protocole par lequel les unités de référence de l'échantillon sont sélectionnées” (Stehman and Czaplewski, 1998)[^fn1]. Le terme “Sampling design” est également utilisé par Cochran (1977)[^fn3] and Särndal et al. (1992)[^fn2] -- Le premier utilise également “sampling plan”.

### 5.5 Sondage/Enquêtee

Särndal et al. (1992)[^fn2] définissent une enquête comme une “investigation partielle d'une population finie”, et précisent que “les concepts d ‘enquête’ et ‘enquête par sondage’ sont utilisés pour désigner des enquêtes statistiques présentant les caractéristiques méthodologiques suivantes: [...] échantillonnage aléatoire [...] plan de mesure [et] estimation”. de facon plus precise une enquete par sondage ou un sondage est une enquête effectuee sur une partie de la population. Cette fraction de la population constitue l'échantillon et les méthodes qui permettent de construire cet echantillon s'appellent méthode d'échantillonnage.

### 5.6 Plan d'enquête

UN “plan de sondage total” définit les procédures pour “obtenir la plus grande précision possible dans les estimations de l'enquête tout en trouvant un équilibre entre les erreurs d'échantillonnage et les erreurs non dues à l'échantillonnage [...] Le plan de sondage donne lieu à des opérations d'enquête” sélection de l'échantillon (Särndal et al., 1992)[^fn2]. Lohr (1999)[^fn5] décrit un plan de sondage total comme “Une philosophie de conception d'enquête visant à minimiser les erreurs de non-échantillonnage ainsi que les erreurs d'échantillonnage..” De plus, dans Lohr (1999) “plan d'enquête” est synonyme de plan d'échantillonnage.

## 6 References

Cochran, W.G., 1977. *Sampling Techniques*, John Wiley & Sons, New York, NY.

Casella, G., & Berger, R. L., 2002. *Statistical Inference* (2nd ed.), Duxbury Press, Pacific Grove, CA.

Lohr, S.L., 1999. *Sampling: Design And Analysis,* CRC Press.

Rice, J.A., 1995. *Mathematical Statistics and Data Analysis* (2nd ed.), Duxbury Press, Belmont, CA.

Stehman, S.V., 2013. Estimating area from an accuracy assessment error matrix. Remote Sensing of Environment, 132, pp.202-211. https://doi.org/10.1016/j.rse.2013.01.016

Stehman, S.V., 2014. Estimating area and map accuracy for stratified random sampling when the strata are different from the map classes. International Journal of Remote Sensing, 35(13), pp.4923-4939. https://doi.org/10.1080/01431161.2014.930207

-----

![](./figures/cc.png)

Cet ouvrage est soumis à une licence [Creative Commons Attribution 3.0 IGO](https://creativecommons.org/licenses/by/3.0/igo/)

Copyright 2020, Banque mondiale. Ce travail a été développé par Pontus Olofsson dans le cadre d'un contrat de la Banque mondiale avec GRH Consulting, LLC pour le développement de nouvelles ressources - et la collecte de ressources existantes - liées à la mesure, la notification et la vérification pour soutenir la mise en œuvre du MRV par les pays.

Matériel révisé par : 

Ana Mirian Villalobos, El Salvador, Ministry of Environment and Natural Resources
Carole Andrianirina, Madagascar, National Coordination Bureau REDD+ (BNCCREDD)
Jennifer Juliana Escamilla Valdez, El Salvador, Ministry of Environment and Natural Resources
Phoebe Oduor, Kenya, Regional Centre For Mapping Of Resources For Development (RCMRD)
Tatiana Nana, Cameroon, REDD+ Technical Secretariat

Attribution : Olofsson, P. (2021). *MRV ouvert : Analyse d'un échantillon de données*. Banque mondiale. Licence :  [Creative Commons Attribution license (CC BY 3.0 IGO)](http://creativecommons.org/licenses/by/3.0/igo/)

![](./figures/wb_fcfc_gfoi.png)